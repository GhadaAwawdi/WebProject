<!DOCTYPE html>
<html  data-ng-init = "CheckNow()" data-ng-app="myApp" data-ng-controller="ebooksCtrl">
<head>
<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="lib/angular.min.js" ></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" href="lib/bootstrap-3.3.7-dist/css/bootstrap.min.css">
<script src="lib/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>

<style>
.test{
	font-size: 17px;
}
</style>
<script>
var app = angular.module('myApp', []);
app.controller('ebooksCtrl', function($scope, $http,$window) {
	var timerhandler;
	var url_string = window.location.href;
	var url = new URL(url_string);
	var c = url.searchParams.get("nickname");
	//console.log(c);
	var pars={
		params:{nickname: c}
	};
	console.log(pars);
    $scope.CheckNow = function()
    {
//    	alert('success');
		
        $.ajax(
        {
            type: 'GET',
            url: 'GetAllLikesNumOrdered',
            success: function(data) 
            {
     //       	alert('success');
                var allcookies = document.cookie;
                cookiearray = allcookies.split(';');
                  // username = cookiearray[0].split('=')[1]; 
                   type = cookiearray[1].split('=')[1];  
                   console.log(type);
                   if(type=="user"){
                       window.location.href='homeUser.html';
                   }
                   else if(type=="admin"){
                		$http.get('GetEbookUserByNickname', pars)
                		.success(function(data,status,headers,config) {
                			$scope.userDetails=data;
                			//alert("success");
                		})
                		.error(function(data,status,headers,config){
                				//alert("failed");
                			console.log(data);
                		});
					$scope.myVar = true;
                  
                	}
                   else{
                	   window.location.href='index.html';
                   }
            }
        });

    }
    //console.log("ajaaax")
    timerhandler = setInterval($scope.CheckNow,50000);
//	nickname="GhadaAw";
//     var data={
//     	params:{nickname:nickname}
//     };
  //  console.log(data);	
	$http.get('GetEbookUserByNickname', pars)
	.success(function(data,status,headers,config) {
		$scope.userDetails=data;
		//alert("success");
	})
	.error(function(data,status,headers,config){
			//alert("failed");
		console.log(data);
	});
    $scope.logout = function(){
		$http.get("Logout").success(function(data, status, headers,config){
           window.location.href='index.html';

		})
		.error(function(data, status, headers,config){
			console.log(data);
		});
	}
});

function goBack() {
	   window.history.back();
}
</script>
<title>profile</title>
</head>
<body data-ng-app="myApp" data-ng-controller="ebooksCtrl">

	<nav class="navbar navbar-inverse">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target="#myNavbar">
					<span class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="homeAdmin.html">Books For All</a>
			</div>
			<div class="collapse navbar-collapse" id="myNavbar">
				<ul class="nav navbar-nav">
					<li><a href="#" onclick="goBack()" title="Back"><i style="size: 100%;" class="glyphicon glyphicon-arrow-left"></i></a> </li>
					<li><a href="homeAdmin.html">Home</a></li>
					<li class="active"><a href="ebooksAdmin.html">E-Books</a></li>
					<li><a href="AllUsers.html">All Users</a></li>
					<li><a href="purchaseHistory.html">Purchase History</a></li>
					<li><a href="unapprovedReviews.html">Unapproved Reviews</a></li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<li><a href="index.html" data-ng-click="logout()"><span class="glyphicon glyphicon-log-out"></span>Logout</a></li>
				</ul>
			</div>
		</div>
	</nav>

	<div class="container test" data-ng-repeat="x in userDetails">

    <div class="row">
        <div class="col-xs-12 col-sm-6 col-md-6">
            <div class="well well-sm" style="width: 1020px; height: 500px; border: transparent; background-color: transparent;">
                <div class="row">
                    <div class="col-sm-6 col-md-4">
<!--                     <img src="http://placehold.it/380x500" alt="" class="img-rounded img-responsive" /> -->
						<img data-ng-src="{{x.photo}}" class="img-rounded img-responsive">
                    </div>
                    <div class="col-sm-6 col-md-8">
                        <h2>username: {{x.username}}</h2>
                        <br>
                        nickname: {{x.nickname}}
                        <br>
                       
                       
                        <p>
                         <i class="glyphicon glyphicon-map-marker"></i>
                        {{x.city}} 
                        <br>
                        &nbsp;&nbsp;&nbsp;&nbsp;{{x.street}}, {{x.apartment}}
                        <br>
                       	&nbsp;&nbsp;&nbsp;&nbsp;{{x.postalCode}}
                       	<br>
                       	</p>
                        <i class="glyphicon glyphicon-envelope"></i>&nbsp;{{x.email}}
                        <br />
                            <i class="glyphicon glyphicon-lock"></i> &nbsp;password: {{x.password}}
                            <br/>
                            <i class="glyphicon glyphicon-earphone"></i>&nbsp;{{x.telephoneNumber}}
                           
                        <div>
                        <i class="glyphicon glyphicon-info-sign"></i>&nbsp;{{x.shortDescription}}
                        </div>
                       
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
	
	
	
</body>
</html>